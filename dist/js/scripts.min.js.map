{"version":3,"sources":["scripts.js","components/image-uploader.js"],"names":["document","addEventListener","event","ImageUploader","_classCallCheck","this","elForm","querySelector","elFileInput","elSubmit","elFileListImage","elFileListSize","state","bindEvents","_this","files","validateInput","clearLists","createFileList","classList","add","formData","Array","from","append","file","request","XMLHttpRequest","console","log","response","open","send","errors","forEach","type","includes","elList","children","item","_this2","reader","readAsDataURL","onload","image","Image","src","target","result","width","height","createElement","newListItemSize","name","innerHTML","size","toPrecision","concat","appendChild","newListItemImage"],"mappings":"aAAAA,SAASC,iBAAiB,mBAAoB,SAASC,GAA9CD,IAAiBE;uZCApBA,yBACJ,SAAAA,IAAcC,gBAAAC,KAAAF,GACZE,KAAKC,OAASN,SAASO,cAAc,mBACrCF,KAAKG,YAAcH,KAAKC,OAAOC,cAAc,gBAC7CF,KAAKI,SAAWJ,KAAKC,OAAOC,cAAc,wBAC1CF,KAAKK,gBAAkBL,KAAKC,OAAOC,cAAc,0CACjDF,KAAKM,eAAiBN,KAAKC,OAAOC,cAAc,yCAChDF,KAAKO,MAAQ,CAPXT,MAAAA,IAUFE,KAAKQ,uEAGM,IAAAC,EAAAT,KAVXA,KAAKG,OAAAA,iBAAmBF,SAAOC,SAAAA,MAsB/BF,KAAKG,YAAYP,iBAAiB,SAAU,SAACC,GAE3CY,EAAKF,MAAMG,MAAQD,EAAKN,YAdfO,MAgBLD,EAAKE,kBAdXF,EAAKR,SAAOL,UAAAA,IAAiB,UAiBzBa,EAAKG,WAAWH,EAAKJ,iBACrBI,EAAKG,WAAWH,EAAKH,gBAErBG,EAAKI,iBAdPJ,EAAAJ,gBAAAS,UAAAC,IAAA,UACAN,EAAAH,eAAAQ,UAAAC,IAAA,iDAWE,IAEAC,EAAKH,IAAAA,SACLI,MAAAC,KAAIlB,KAACK,MAAAA,OAAgBS,QAAUC,SAAAA,GAgBjCC,EAASG,OAAO,gBAAiBC,KAZlC,IAfDC,EAAA,IAAAC,eAgBDD,EAAAzB,iBAAA,OAAA,WAED2B,QAAAC,IAAAH,EAAAI,YAiBEJ,EAAQK,KAAK,OA3BJd,kBA4BTS,EAAQM,KAAKX,2CARZ,IAFDY,EAAA,EA2BA,OAtBAP,MAAAA,KAAQzB,KAAAA,MAAAA,OAAiBiC,QAAQ,SAAAT,GAAjCA,EAAAU,KAAAC,SAAA,WAIAV,GAAA,MAkBIO,qCAJDI,GAEFf,MANDC,KAAAc,EAAA9B,cAAA,MAAA+B,UAAAJ,QAAA,SAAAK,GAQAA,EAAIN,oDAkBW,IAAAO,EAAAnC,KACfiB,MAAMC,KAAKlB,KAAKO,MAAMG,OAAOmB,QAAS,SAAAT,GATtCH,IAAMC,EAAKc,IAAO9B,WAEjBkC,EAFDC,cAAAjB,GAGDgB,EAAAE,OAAA,SAAAzC,GAED,IAAA0C,EAAA,IAAAC,MAcMD,EAAME,IAAM5C,EAAM6C,OAAOC,OAEzBJ,EAAMD,OAAS,WACblB,EAAKwB,MAAQL,EAAMK,MAdVxB,EAAAyB,OAAAN,EAAAM,OACf5B,IAAMC,EAANvB,SAAAmD,cAAsC1B,MAEpC2B,EAAApD,SAAAmD,cAAA,MAGAV,EAAOC,UAAPjB,EAAA4B,KAeID,EAAgBE,WAAa7B,EAAK8B,KAAO,MAAMC,YAAY,GAA/B,uCAAAC,OAA2EhC,EAAKwB,MAAhF,SAAAQ,OAA6FhC,EAAKyB,OAAlG,aAb9BV,EAAMI,gBAAQrC,cAEd,MAAAmD,YAAAC,GAcEnB,EAAK7B,eAAeJ,cAAc,MAAMmD,YAAYN","file":"scripts.min.js","sourcesContent":["document.addEventListener('DOMContentLoaded', function(event) {\r\n\r\n  const imageUploader = new ImageUploader();\r\n\r\n});\r\n","class ImageUploader {\r\n  constructor() {\r\n    this.elForm = document.querySelector('#image-uploader');\r\n    this.elFileInput = this.elForm.querySelector('#file_upload');\r\n    this.elSubmit = this.elForm.querySelector('input[type=\"submit\"]');\r\n    this.elFileListImage = this.elForm.querySelector('.image-uploader__list.list--file-image');\r\n    this.elFileListSize = this.elForm.querySelector('.image-uploader__list.list--file-size');\r\n    this.state = {\r\n      files: []\r\n    }\r\n    this.bindEvents();\r\n  }\r\n\r\n  bindEvents() {\r\n\r\n    this.elForm.addEventListener('submit', (event) => {\r\n      /*\r\n      if (this.state.files.length <= 0) {\r\n        event.preventDefault();\r\n      }\r\n      */\r\n      //event.preventDefault();\r\n      //this.postInput();\r\n    });\r\n    \r\n    this.elFileInput.addEventListener('change', (event) => {\r\n\r\n      this.state.files = this.elFileInput.files;\r\n\r\n      if (this.validateInput()) {\r\n        this.elSubmit.classList.add('active');\r\n\r\n        this.clearLists(this.elFileListImage);\r\n        this.clearLists(this.elFileListSize);\r\n  \r\n        this.createFileList();\r\n        this.elFileListImage.classList.add('active');\r\n        this.elFileListSize.classList.add('active');\r\n      }\r\n\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Posts the uploaded files to the server. The server will generate the images.\r\n   */\r\n  postInput() {\r\n    const url = '?action_submit';\r\n\r\n    let formData = new FormData();\r\n\r\n    Array.from(this.state.files).forEach( file => {\r\n      formData.append('file_upload[]', file);\r\n    });\r\n\r\n    let request = new XMLHttpRequest();\r\n    request.addEventListener('load', () => {\r\n      console.log(request.response);\r\n    });\r\n\r\n    request.open('POST' , url);\r\n    request.send(formData);\r\n  }\r\n\r\n  /**\r\n   * Validate the type of file being uploaded. Only allow type: image/*.\r\n   */\r\n  validateInput() {\r\n    let errors = 0;\r\n  \r\n    Array.from(this.state.files).forEach( file => {\r\n\r\n      if (!file.type.includes('image')) {\r\n        errors += 1;\r\n      }\r\n\r\n    });\r\n\r\n    if (errors) return false;\r\n    return true;\r\n  }\r\n\r\n\r\n  /**\r\n   * Clears all list children from the DOM.\r\n   * @param {elList} list \r\n   */\r\n  clearLists(elList) {\r\n    Array.from(elList.querySelector('ul').children).forEach( item => {\r\n      item.remove();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Creates a list item for each file in the FileList & adds it to the image uploader list\r\n   */\r\n  createFileList() {\r\n    Array.from(this.state.files).forEach( file => {\r\n\r\n      // Get the image dimensions\r\n      const reader = new FileReader();\r\n\r\n      reader.readAsDataURL(file);\r\n      reader.onload = (event) => {\r\n        const image = new Image();\r\n\r\n        // Set the Base64 string returned from the FileReader as the images source\r\n        image.src = event.target.result;\r\n\r\n        image.onload = () => {\r\n          file.width = image.width;\r\n          file.height = image.height;\r\n\r\n          let newListItemImage = document.createElement('li');\r\n          let newListItemSize = document.createElement('li');\r\n    \r\n          newListItemImage.innerText = file.name;\r\n          newListItemSize.innerHTML = (file.size / 1024).toPrecision(5) + `<span class=\"byte-size\">kilobytes | ${file.width}px x ${file.height}px</span>`;\r\n    \r\n          this.elFileListImage.querySelector('ul').appendChild(newListItemImage);\r\n          this.elFileListSize.querySelector('ul').appendChild(newListItemSize);\r\n        }\r\n      }\r\n    });\r\n\r\n    \r\n  }\r\n\r\n}"]}